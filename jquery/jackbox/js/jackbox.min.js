(function(c){function lb(){A=c(window);Yb=c("body");mb=c("body, html");t=c("<div />").addClass("jackbox-modal");u=c("<div />").addClass("jackbox-holder");wa=c("<div />").addClass("jackbox-wrapper");Q=c("<div />").addClass("jackbox-preloader");ba=c("<span />").addClass("jackbox-panel jackbox-panel-left");ja=c("<span />").addClass("jackbox-panel jackbox-panel-right");var a=l.createDocumentFragment();a.appendChild(wa[0]);a.appendChild(Q[0]);t[0].appendChild(a);a=l.createDocumentFragment();a.appendChild(ba[0]); a.appendChild(ja[0]);a.appendChild(u[0]);wa[0].appendChild(a);xa=c("<div />").addClass("jackbox-container");ka||(a=c("<span />").addClass("jackbox-pre-outside").appendTo(Q),c("<span />").addClass("jackbox-pre-inside").appendTo(a));la*=2;Ra=0;a=l.createDocumentFragment();nb&&(v=c(nb).hide(),a.appendChild(v[0]));a.appendChild(xa[0]);ob&&(w=c(ob).hide(),a.appendChild(w[0]));u[0].appendChild(a);pb=-(y+ya);ma=[];Ea=[];D=[];E=[];qb.each(Yc);N&&(c.address.internalChange(rb),c.address.externalChange(Zc)); Zb=!0;Fa&&(N?setTimeout(Fa,250):Fa(),Fa=null);qb=Ea=nb=ob=ma=null}function Yc(){var a=c(this).attr("data-group").split(" ").join("").toLowerCase();if(ka){for(var b=E.length,e=!1;b--;)if(E[b]===a){e=!0;break}e||$b(a)}else-1===E.indexOf(a)&&$b(a)}function $b(a){E[E.length]=a;Ea=[];c(".jackbox[data-group="+a+"]").each(ac);D[D.length]=Ea;Sa++}function ac(a){isNaN(a)?f=a:(f=c(this).data({id:a,cat:Sa}),Ea[a]=f);if(h=f.attr("href")||f.attr("data-href")){var b,a="#"!==h.charAt(0)?h.toLowerCase().split(".").pop(): "html";if(b=-1!==h.search("youtube.com")?"youtube":-1!==h.search("vimeo.com")?"vimeo":"mp4"===a?"local":!1){if(f.data("type",b),!f.attr("data-thumbnail"))if("vimeo"===b){var e=f;c.getJSON("http://vimeo.com/api/v2/video/"+h.split("http://vimeo.com/")[1]+".json?callback=?",{format:"json"},function(a){e.attr("data-thumbnail",a[0].thumbnail_small)})}else"youtube"===b&&f.attr("data-thumbnail","http://img.youtube.com/vi/"+h.split("http://www.youtube.com/watch?v=")[1]+"/1.jpg")}else if("jpg"===a||"png"=== a||"jpeg"===a||"gif"===a)f.data("type","image");else switch(a){case "mp3":f.data("type","audio");break;case "swf":f.data("type","swf");break;case "html":f.data("type","html");break;default:f.data("type","iframe")}f.on("click.jackbox",$c);if(H=f.attr("data-description")){if(ma)if(a=ma.indexOf(H),-1===a){H=c(H);if(!H.length)return;ma[ma.length]=H}else H=ma[a];else if(H=c(H),!H.length)return;f.data("description",H)}}}function Zc(a){if(cc){cc=!1;var b=l.URL.split("?url=");if(2===b.length){window.location= b[0]+"#/"+b[1];return}}clearTimeout(Ga);dc(a.value);-1!==z?ec?(ec=!1,rb()):Ga=setTimeout(rb,750):R&&sb()}function rb(a){"object"===typeof a&&(clearTimeout(Ga),dc(a.value));-1!==z?fc():R&&sb()}function dc(a){F&&(!ca&&!za)&&n[d].removeClass("jb-thumb-active");"/"!==a?(a=a.split("/"),3===a.length?(d=parseInt(a[2],10)-1,isNaN(d)&&(d=0),da=a[1]):isNaN(a[1])?(d=0,da=a[1]):(d=parseInt(a[1],10)-1,da="/")):(da="/",d=0);if("/"!==da)for(a=Sa;a--;){if(E[a]===da){z=a;I=D[z].length;O=1!==I;break}}else z=-1;za= !1}function $c(a){a.stopPropagation();a.preventDefault();a=c(this).data();Ta(a.cat,a.id,!0)}function Ta(a,b,e){clearTimeout(Ga);if(!e){if(F)for(e=n.length;e--;)n[e].off("click.jackbox");ba.off(".jackbox");ja.off(".jackbox");B&&tb&&i.cjSwipe("unbindSwipe")}N?c.address.value(E[a]+"/"+(b+1)):(F&&(!ca&&!za)&&n[d].removeClass("jb-thumb-active"),d=b,z=a,I=D[z].length,O=1!==I,fc())}function ub(a){if(a&&(a.stopPropagation(),Ha))return!1;R&&(F&&!ca&&n[d].removeClass("jb-thumb-active"),d<D[z].length-1?d++: d=0,za=!0,Ta(z,d))}function vb(a){if(a&&(a.stopPropagation(),Ha))return!1;R&&(F&&!ca&&n[d].removeClass("jb-thumb-active"),0<d?d--:d=D[z].length-1,za=!0,Ta(z,d))}function fc(){Ua=D[z];if(f=Ua[d])h=f.attr("href")||f.attr("data-href"),R?(Ha=!0,gc(),hc()):(R=!0,B||(mb.stop(),Ra=A.scrollTop()),t.appendTo(Yb).one("click.jackbox",ic),jc=t.parents().each(ad),kc||(kc=!0,wb=parseInt(u.css("padding-left"),10)+parseInt(u.css("padding-right"),10),Ia=parseInt(u.css("padding-top"),10)+parseInt(u.css("padding-bottom"), 10),lc=parseInt(ba.css("width"),10)+14,Va=Ia+la,xb=y+(ya<<1),Wa=parseInt(Q.css("margin-top"),10),mc=Wa-(xb>>1),nc=parseInt(u.css("padding-left"),10),oc=parseInt(u.css("padding-top"),10),J=c(".jackbox-fullscreen"),J.length||(J=null),ea=!yb&&Xa&&O?0:pb,na=!B&&"safari"!==Ya&&("webkitRequestFullScreen"in t[0]||"mozFullScreenEnabled"in l)),C=A.width(),K=A.height(),u.css({width:C,height:K,marginLeft:-(C>>1)-nc,marginTop:-(K>>1)-oc}),Jacked.fadeIn(t[0],{callback:bd}),pc=setTimeout(hc,250),wa.on("click.jackbox", qc))}function ad(){c(this).addClass("jackbox-overflow")}function cd(){c(this).removeClass("jackbox-overflow")}function bd(){A[0].scrollTo(0,0)}function hc(){F&&(n[d].addClass("jb-thumb-active"),ca?ca=!1:zb(!1,!0));var a=f.attr("data-autoplay")?f.attr("data-autoplay"):rc,b=f.data("description")||null,e=f.attr("data-title")||"",bc;Za="true"===f.attr("data-scaleUp");$a=b?b.html():!1;S=f.data("type");e?(Ab=e,fa=escape(Ab)):(fa=!1,"undefined"!==typeof x&&(x.data("links")&&x.data("links").off(".jackbox"), x.empty()));B&&(tb="image"===S||"html"===S);"image"!==S&&sc();568<C?Q.css("margin-top",0===ea?mc:Wa):Q.css("margin-top",Wa);wa.show();Q.addClass("jackbox-spin-preloader");switch(S){case "image":Ja=!0;i=c("<img />").addClass("jackbox-content").one("load.jackbox",Ka).prependTo(xa);i.attr("src",h);break;case "youtube":oa(dd.split("{url}").join(h.split("watch?v=")[1]).split("{autoplay}").join("true"===a?1:0));break;case "vimeo":oa(ed.split("{url}").join(h.substring(h.lastIndexOf("/"))).split("{autoplay}").join(a)); break;case "local":b=Bb();e=f.attr("data-flashHasPriority")?f.attr("data-flashHasPriority"):tc.toString();bc="false"===e&&na&&"firefox"!==Ya;b=f.attr("data-poster")?b+f.attr("data-poster"):"false";oa(fd+"?video="+h+"&autoplay="+a+"&flashing="+e+"&width="+T+"&height="+U+"&poster="+b,!0);break;case "audio":Bb();oa(gd+"?audio="+h+"&title="+(f.attr("data-audiotitle")?f.attr("data-audiotitle"):fa)+"&autoplay="+a);break;case "swf":Bb();oa(hd+"?swf="+h+"&width="+(j.toString()+"&height="+g.toString()));break; case "html":a=c(h);i=c("<div />").addClass("jackbox-content jackbox-html").html(a.length?a.html():"").prependTo(xa);i.css("width",j);f.attr("data-height",i.outerHeight(!0));sc();Ka();break;default:oa(h,!1,!0)}na&&(!bc?J.show():J.hide())}function Bb(){if(-1===h.search("http")){var a=l.URL.split("#")[0];"/"!==a[a.length-1]&&(a=a.substring(0,a.lastIndexOf("/")+1));h=a+h;return a}}function id(){ga.css("visibility","hidden")}function jd(){p.data("offLeft",p.offset().left)}function uc(){Aa.css({opacity:0, visibility:"hidden"})}function vc(a){"object"===typeof a&&a.stopPropagation();q<I-ha&&(q++,ab(!1,!0))}function wc(a){"object"===typeof a&&a.stopPropagation();0<q&&(q--,ab(!1,!0))}function kd(a){a.stopPropagation();a=c(this).parent();a.addClass("jb-thumb-fadein");B||a.addClass("jb-thumb-hover");a.data("id")===d&&a.addClass("jb-thumb-active")}function xc(a){a.stopPropagation();if(Ha)return!1;a=c(this).data("id");a!==d&&(F&&n[d].removeClass("jb-thumb-active"),d=a,ca=!0,Ta(z,d))}function ld(){La?yc(): (A.off(".jackbox"),La=!0,l.mozFullScreenEnabled?(l.addEventListener("mozfullscreenchange",bb,!1),t[0].mozRequestFullScreen()):t[0].webkitRequestFullScreen&&(l.addEventListener("webkitfullscreenchange",bb,!1),t[0].webkitRequestFullScreen()))}function bb(){l.webkitIsFullScreen||l.mozFullScreen?L(!0):yc(!0)}function Cb(a){l.removeEventListener(a.type,Cb,!1);L(!0);A.on("resize.jackbox",L)}function yc(a){La=!1;l.mozFullScreenEnabled?(l.removeEventListener("mozfullscreenchange",bb,!1),a?(L(!0),A.on("resize.jackbox", L)):(l.addEventListener("mozfullscreenchange",Cb,!1),l.mozCancelFullScreen())):t[0].webkitRequestFullScreen&&(l.removeEventListener("webkitfullscreenchange",bb,!1),a?(L(!0),A.on("resize.jackbox",L)):(l.addEventListener("webkitfullscreenchange",Cb,!1),l.webkitCancelFullScreen()))}function sc(){Ja=!1;T=f.attr("data-width")?parseInt(f.attr("data-width"),10):zc;U=f.attr("data-height")?parseInt(f.attr("data-height"),10):Ac;Za="true"===f.attr("data-scaleUp");Bc()}function Cc(){Db=!1}function Bc(){cb=T+ wb+lc+la;Eb=U+Va;L()}function gc(){clearTimeout(pc);Jacked.stopTween(u[0]);A.off(".jackbox");i&&(Jacked.stopTween(i[0]),i.remove(),i=null);db&&(db.remove(),db=null);v&&(Jacked.stopTween(v[0],!0),v.hide());w&&(Jacked.stopTween(w[0],!0),w.hide());r&&(r.removeClass("jb-info-inactive"),Jacked.stopTween(G[0]),G.empty().hide())}function ic(a){a.stopPropagation();N?c.address.value(""):sb()}function sb(){clearTimeout(Ga);gc();t.unbind(".jackbox");if(O){pa&&pa.off(".jackbox");qa&&qa.off(".jackbox");Ma&&p&& p.off(".jackbox");Jacked.stopTween(ja[0],!0);Jacked.stopTween(ba[0],!0);var a={opacity:0,visibility:"hidden"};ja.off(".jackbox").css(a);ba.off(".jackbox").css(a)}else ra&&ra.show(),s&&s.show();wa.hide().off(".jackbox");Q.removeClass("jackbox-spin-preloader");"undefined"!==typeof x&&(x.data("links")&&x.data("links").off(".jackbox"),x.empty());na&&J.off(".jackbox");sa&&sa.unbind(".jackbox");r&&r.off(".jackbox");if(F){Jacked.stopTween(V[0]);for(V.off(".jackbox").hide();n.length;)a=n[0],Jacked.stopTween(a[0]), a.remove(),n.shift();W.off(".jackbox").hide();X.off(".jackbox").hide();B&&p.cjSwipe("unbindSwipe");Jacked.stopTween(M[0]);M.empty().css("margin-left",0);s&&(s.off(".jackbox"),s&&(P.hide(),Y.show()));F=n=null}jc.each(cd);Jacked.fadeOut(t[0],{duration:1E3,callback:md});u.css({marginLeft:nd,marginTop:od});B||setTimeout(pd,10);ga&&ga.css("visibility","hidden");f=R=La=ca=Fb=eb=za=Gb=Ba=null}function pd(){0!==Ra&&mb.animate({scrollTop:Ra},{duration:300,queue:!1})}function md(){t.detach()}function qd(a){!a? ub():vb()}function rd(a,b){if(!R&&"success"===b.toLowerCase()&&a){var e=a.length,f=document.URL;for(f.substring(0,f.lastIndexOf("/"));e--;)c("<img />").attr("src",Dc+"/"+a[e].split("../").join(""))}}function sd(){var a=c(this),b=a.next("img"),e=b.attr("src");b.length&&(a=c("<img />").attr({width:b.attr("width"),height:b.attr("height")}).data("parent",a).one("load.jackbox",td).insertAfter(b),b.remove(),a.attr("src",e))}function td(){var a=c(this),b=a.data("parent"),e=parseInt(b.css("width"),10)||b.width(), f=parseInt(b.css("height"),10)||b.height(),b=c("<canvas />").addClass("jackbox-canvas-blur").attr({width:e,height:f}).insertBefore(b),f=Date.now(),e=f+1,f=f+2;a.attr("id",e);b.attr("id",f);StackBlurImage(e,f,19)}function ud(){var a=c(this);a.parent().data({tip:a,tipWidth:a.width()-27,tipHeight:a.height()+17}).on("mouseenter.jackbox",vd).on("mouseleave.jackbox",wd)}function vd(){var a=c(this),b=a.offset(),e=a.data();e.tipX=b.left;e.tipY=b.top;e.tip.css({opacity:1,visibility:"visible"});a.on("mousemove.jackbox", Ec)}function wd(){var a=c(this).off("mousemove.jackbox");ka?a.data("tip").css("opacity",0):a.data("tip").css({opacity:0,visibility:"hidden"})}function xd(a){a.stopImmediatePropagation()}function qc(a){c(a.target).is("a")||(a.stopPropagation(),a.preventDefault())}var k={useThumbs:!0,deepLinking:!0,autoPlayVideo:!1,flashVideoFirst:!1,defaultVideoWidth:960,defaultVideoHeight:540,thumbnailWidth:75,thumbnailHeight:50,useThumbTooltips:!0,preloadGraphics:!0,showInfoByDefault:!1,thumbsStartHidden:!1,fullscreenScalesContent:!0, defaultShareImage:"jackbox/img/default_share.jpg"},la=10,ya=2,Dc="jackbox",yd=Dc+"/php/graphics.php",hd="jackbox/modules/jackbox_swf.html",fd="jackbox/modules/jackbox_video.html",gd="jackbox/modules/jackbox_audio.html",ed="http://player.vimeo.com/video{url}?title=0&byline=0&portrait=0&autoplay={autoplay}&color=FFFFFF&wmode=transparent",dd="http://www.youtube.com/embed/{url}?autoplay={autoplay}&autohide=1&hd=1&iv_load_policy=3&showinfo=0&showsearch=0&wmode=transparent",nb='<div class="jackbox-top clearfix"><div class="jackbox-social"></div><div class="jackbox-top-icons"><span class="jackbox-fullscreen"><span class="jackbox-button jackbox-fs"></span><span class="jackbox-button jackbox-ns"></span></span><span class="jackbox-button jackbox-button-margin jackbox-close"></span></div><div />', ob='<div class="jackbox-bottom clearfix"><div class="jackbox-controls"><span class="jackbox-button jackbox-arrow-left"></span><span class="jackbox-button jackbox-arrow-right"></span></div><div class="jackbox-title-text"><span class="jb-current"></span><span class="jb-divider">/</span><span class="jb-total"></span><span class="jackbox-title-txt"></span></div><div class="jackbox-bottom-icons"><span class="jackbox-button jackbox-info"></span><span class="jackbox-button-margin jackbox-button-thumbs"><span class="jackbox-button jackbox-hide-thumbs"></span><span class="jackbox-button jackbox-show-thumbs"></span></span></div></div>', Hb,w,na,nc,oc,Ib,xb,fb,pb,La,Fc,Ia,wb,Gc,ga,lc,Jb,M,p,Kb,X,v,G,Z,P,Y,ja,J,Db,Ra,ba,fa,W,xa,Q,ha,ma,Lb,Ab,tb,Ba,Aa,ea,s,sa,$a,ra,Hc,Ma,Ic,ta,Ca,q,wa,ua,qa,O,Wa,pa,Za,Jc,B,Va,gb,Na,t,x,f,Ea,r,l,h,j,A,I,Kc,E,g,da,D,ka,va,Mb,pc,Fa,n,Yb,u,qb,T,hb,Ga,Lc,i,U,Ja,C,K,cb,Eb,S,jc,Ya,$,H,R,kc,mb,Xa,Ha,ca,F,od,Fb,Ua,N,Oa,db,V,eb,mc,nd,Mc,za,Nb,Gb,rc,aa,Zb,y,tc,Nc,Oc,yb,zc,Ac,d=1,z=-1,Sa=0,ec=!0,cc=!0,Pc={init:function(a,b){!Mc&&"undefined"!==typeof Jacked&&(b&&c.extend(k,b),Xa=k.useThumbs,N=k.deepLinking,Ma=k.useThumbTooltips, rc=k.autoPlayVideo,aa=k.thumbnailWidth,Lc=k.fullscreenScalesContent,y=k.thumbnailHeight,tc=k.flashVideoFirst,Oc=k.showInfoByDefault,yb=k.thumbsStartHidden,Nc=k.defaultShareImage,zc=k.defaultVideoWidth,Ac=k.defaultVideoHeight,l=document,Mc=!0,$=aa+ya,hb=-1!==l.URL.search("file:///"),k.preloadGraphics&&!hb&&c.getJSON(yd+"?path=../img/graphics/",rd),qb=a,k=null,ka=Jacked.getIE(),B=Jacked.getMobile(),Ya=Jacked.getBrowser(),Kc="ie"===Ya,"undefined"!==typeof c.address&&N?Kc?(lb(),c.address.update()):c.address.init(lb): (N=!1,lb()),"undefined"!==typeof StackBlurImage&&(!hb&&!ka)&&c(".jackbox-hover-blur").each(sd),c(".jackbox-tooltip").each(ud))},frameReady:function(){R&&Ka()},newItem:function(a,b){var e=E.length,c=-1,f,d;if(b&&"object"===typeof b){var g,j,i;for(g in b)"trigger"!==g&&(j="data-"+g,i=b[g],a.attr(j,i),"group"===g&&(d=i))}else b=null;d||(d=a.attr("data-group"));if(d){for(d=d.split(" ").join("").toLowerCase();e--;)if(E[e]===d){c=e;break}if(-1<c){d=D[c];-1!==d.indexOf(a)&&(a.trigger("click"),f=!0);if(f)return; e=d.length;d[e]=a}else c=E.length,e=D.length,E[c]=d,Sa++,D[e]=[a],e=0;ac(a);a.data({id:e,cat:c});b&&b.trigger&&a.trigger("click")}}},oa,ib={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen"};oa=function(a,b,e){ib.width=j;ib.height=g;ib.scrolling=!e?"no":"auto";i=c("<iframe />").attr(ib).addClass("jackbox-content").prependTo(xa);if(!b)i.one("load.jackbox",Ka);i.attr("src",a)};var Ka,Ob={};Ka=function(a){a&& a.stopPropagation();Ja&&(T=i.width()||i[0].width,U=i.height()||i[0].height,Bc());Ob.width=j;Ob.height=g;i.css(Ob);Pb(!0);A.on("resize.jackbox",L)};var Pb,ia={},Da={},Pa={};Pb=function(a){if(a){260>j&&(va+=260-j);a=Math.max(j,260);if(a===Ba&&g===Lb){Qb();return}ia.callback=Qb;ia.duration=Ba?50<Math.abs(a-Ba)||50<Math.abs(g-Lb)?600:300:600}else a=j,Pa.width=a,ia.duration=300,delete ia.callback,v&&Jacked.tween(v[0],Pa,ia),w&&Jacked.tween(w[0],Pa,ia),Pa.height=g,Jacked.stopTween(i[0],!0),Jacked.tween(i[0], Pa,ia);Da.marginLeft=-((va>>1)+0.5|0);Da.marginTop=-((Mb>>1)+0.5|0);Da.height=g;Da.width=a;Ba||(Da.opacity=1);Jacked.tween(u[0],Da,ia);Ba=a;Lb=g};var Qb,jb={},Qc={opacity:1,visibility:"visible"};Qb=function(){Rc();Q.removeClass("jackbox-spin-preloader");var a=Math.max(j,260);jb.duration=600;Ja&&!ka?Jacked.fadeIn(i[0],{duration:1E3}):(i.show(),("audio"===S||"local"===S)&&i[0].contentWindow.cjInit());jb.duration=300;ka?(v&&v.css("width",a).show(),w&&w.css("width",a).show()):(v&&(v.css("width",a),Jacked.fadeIn(v[0], jb)),w&&(w.css("width",a),Jacked.fadeIn(w[0],jb)));r&&$a?(r.show(),G.html($a).show(),Z=-G.outerHeight(),ga.css("height",-Z<g?-Z:g),Oc?(Ca=!0,r.addClass("jb-info-inactive"),G.css("margin-top",0)):(Ca=!1,G.css("margin-top",Z))):r&&(r.hide(),G.hide());Ha=!1;!eb&&O&&(ba.css(Qc),ja.css(Qc));if(!Gb&&Xa&&O){var a=D[z],b=[],e=I,f,d,h,m,k;for(Gb=!0;e--;)h=a[e],h.attr("data-thumbnail")?b[e]=!1:(f=h.children("img"),f.length?(h.attr("data-thumbnail",f.attr("src")),b[e]=f):("image"===h.data("type")?h.attr("data-thumbnail", h.attr("href")||h.attr("data-href")):h.attr("data-thumbnail","jackbox/img/thumbs/default.jpg"),b[e]=!1));n=[];V||(e=l.createDocumentFragment(),h=y>>1,V=c("<div />").addClass("jackbox-thumb-holder").css("height",y).appendTo(t),p=c("<div />").addClass("jackbox-thumb-panel").css("height",y),X=c("<div />").addClass("jackbox-thumb-right"),W=c("<div />").addClass("jackbox-thumb-left"),e.appendChild(p[0]),e.appendChild(X[0]),e.appendChild(W[0]),V[0].appendChild(e),M=c("<div />").addClass("jackbox-thumb-strip").appendTo(p), W.css("top",h),X.css("top",h));h=l.createDocumentFragment();for(e=0;e<I;e++){d=n[e]=c("<div />").data("id",e).addClass("jackbox-thumb").css({width:aa,height:y,left:$*e}).on("click.jackbox",xc);if(Ma&&(f=Ua[e].attr("data-thumbTooltip")||Ua[e].attr("data-title")))d.data("theTitle",f).on("mouseenter.jackbox",Sc).on("mouseleave.jackbox",uc);h.appendChild(d[0]);f=c("<img />").addClass("jb-thumb").one("load.jackbox",kd).appendTo(d);d.data("theThumb",f);b[e]?(d=b[e].attr("width")||b[e].width(),m=b[e].attr("height")|| b[e].height()):(d=aa,m=y);d>aa&&m>y&&(k=d>m?aa/d:y/m,d*=k,m*=k,m<y&&(k=(y-m)/y,d+=d*k,m+=m*k),d<aa&&(k=(aa-d)/aa,d+=d*k,m+=m*k),d!==(d|0)&&(d=d+1|0),m!==(m|0)&&(m=m+1|0));f.attr({width:d,height:m,src:a[e].attr("data-thumbnail")})}M[0].appendChild(h);Gc=n.length;Kb=$*e;F=!0;q=0;V.on("click.jackbox",qc).show();Rb();s&&(yb?(Y.hide(),P.show(),V.css("bottom",ea)):(P.hide(),Y.show(),V.css("bottom",0)),s.on("click.jackbox",Tc))}if(!eb){eb=!0;if(na)J.on("click.jackbox",ld);if(sa)sa.one("click.jackbox",ic); if(r)r.on("click.jackbox",Uc);if(O){if(qa)qa.on("click.jackbox",ub);if(pa)pa.on("click.jackbox",vb);if(Ma&&p)p.on("mouseenter.jackbox",jd)}}if(O){if(F)for(a=n.length;a--;)n[a].on("click.jackbox",xc);ba.on("click.jackbox",vb);ja.on("click.jackbox",ub);B&&tb&&i.cjSwipe("touchSwipe",qd)}};var Rc,kb={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen",scrolling:"no"};Rc=function(){if(!Hc){Hc=!0;Na=c(".jb-total"); r=c(".jackbox-info");ta=c(".jb-divider");ua=c(".jb-current");sa=c(".jackbox-close");gb=c(".jackbox-title-text");x=c(".jackbox-title-txt");ra=c(".jackbox-controls");pa=c(".jackbox-arrow-left");Oa=c(".jackbox-social");qa=c(".jackbox-arrow-right");s=c(".jackbox-button-thumbs");P=c(".jackbox-show-thumbs");Y=c(".jackbox-hide-thumbs");x.length||(x=null);gb.length||(gb=null);pa.length||(pa=null);ta.length||(ta=null);qa.length||(qa=null);ra.length||(ra=null);sa.length||(sa=null);Oa.length||(Oa=null);if(!ua.length|| !Na.length)ua=null;na?(c(".jackbox-ns").hide(),J.length||(J=na=null)):J&&J.hide();Xa?s.length&&P.length&&Y.length?P.hide():s=P=Y=null:(s.hide(),s=P=Y=null);r.length?(ga=c("<div />").addClass("jackbox-info-text").appendTo(xa).css("visibility","hidden"),G=c("<div />").addClass("jackbox-description-text").appendTo(ga)):r=null;Ma&&(Aa=c("<span />").addClass("jackbox-thumb-tip").css("bottom",y),Ib=c("<span />").addClass("jackbox-thumb-tip-text").text("render me").appendTo(Aa),Aa.appendTo(t),Fc=(parseInt(Aa.css("padding-left"), 10)<<1)-(ya<<1))}O||(ra&&ra.hide(),s&&s.hide());if(gb){"false"===fa&&(fa=!1);var a=x&&fa,b=a?" -&nbsp;":"";ua&&O?(ua.text(d+1).show(),Na.html(I+b).show(),ta&&ta.show()):(Na&&Na.hide(),ua&&ua.hide(),ta&&ta.hide());a&&(x.html(Ab),a=x.children("a"),a.length&&(a.on("click.jackbox",xd),x.data("links",a)))}if(Oa&&!hb){var e,a=l.URL.split("#")[0],b=a.length-1;-1!==a.search("/")&&("/"!==a.charAt(b)?(N?e=a+"#/"+da+"/"+(d+1):e=a,a=a.substring(0,a.lastIndexOf("/"))):(a=a.substring(0,b),N?e=a+"/#/"+da+"/"+(d+ 1):e=a));Ja?b=f.attr("href")||f.attr("data-href"):(b=f.children("img"),b=b.length?b.attr("src"):Nc);-1===b.search("http")&&(b="/"!==b.charAt(0)?a+"/"+b:a+b);kb.width=200;kb.height=21;kb.src="jackbox/modules/jackbox_social.php?url="+encodeURIComponent(e)+"&poster="+b+"&title="+(fa?escape(fa.replace(/(<([^>]+)>)/ig,"")):escape(l.title));db=c("<iframe />").attr(kb).appendTo(Oa)}};var Uc,Sb={},Tb={duration:300};Uc=function(a){a&&a.stopPropagation();Ca?(Sb.marginTop=Z,Tb.callback=id,r.removeClass("jb-info-inactive")): (r.addClass("jb-info-inactive"),ga.css("visibility","visible"),Sb.marginTop=0,delete Tb.callback);Jacked.tween(G[0],Sb,Tb);Ca=!Ca};var Sc,Ub={opacity:1,visibility:"visible"};Sc=function(){B&&(clearTimeout(Jc),Jc=setTimeout(uc,2E3));var a=c(this),b,e,d;Ib.text(a.data("theTitle"));b=parseInt(Ib.css("width"),10);d=p.data("offLeft");a=a.offset().left;e=d+p.width()-b-Fc;Ub.width=b;Ub.left=a<d?d:a>e?e:a;Aa.css(Ub)};var Tc,Vc={},zd={duration:300};Tc=function(a){a.stopPropagation();0===ea?(ea=pb,s&&(Y.hide(), P.show())):(ea=0,s&&(P.hide(),Y.show()));Vc.bottom=ea;Jacked.tween(V[0],Vc,zd);569>C||(L(),Pb())};var Rb,Vb={};Rb=function(a){var b=C-160;Kb<b?(ha=Gc,Nb=!1):(ha=b/$|0,Nb=!0);fb=$*ha-ya;Jb=ha-1;Vb.marginLeft=-(fb>>1)-ya;Vb.width=fb;p.css(Vb);M.css("width",Kb);zb(a)};var zb,Wc={},Ad={duration:300};zb=function(a,b){if(a)q=d,0!==d&&d+ha>I&&(q=I-ha),Jacked.stopTween(M[0]),M.css("left",q*-$);else{if(0===d)q=0;else if(d>q+Jb)for(;d>q+Jb;)q++;b?(Wc.left=q*-$,Jacked.tween(M[0],Wc,Ad)):(Jacked.stopTween(M[0]), M.css("left",q*-$))}ab(a,!1)};var ab,Xc={},Bd={duration:300};ab=function(a,b){W.off(".jackbox");X.off(".jackbox");if(Nb)if(B&&p.cjSwipe("unbindSwipe"),q<I-ha?(X.on("click.jackbox",vc).show(),B&&p.cjSwipe("touchSwipeLeft",vc,!0)):X.hide(),0<q?(W.on("click.jackbox",wc).show(),B&&p.cjSwipe("touchSwipeRight",wc,!0)):W.hide(),b)Xc.left=q*-$,Jacked.tween(M[0],Xc,Bd);else{if(a||!Fb){var c=p.offset().left;W.css("left",c);X.css("left",c+fb);Fb=!0}}else W.hide(),X.hide()};var L,Wb={opacity:1},Qa={};L=function(a){if(Db)clearTimeout(Hb), Hb=setTimeout(Cc,100);else{C=A.width();K=Math.max(A.height(),226);var b=568<C&&0===ea?xb:0;Ic="audio"!==S&&"html"!==S?!La?Za:Za||Lc:!1;if(cb<C&&Eb+b<K&&!Ic)j=T,g=U;else{j=C/cb;g=K/Eb;var c=j>g?g:j;j=T*c;g=U*c;C>K?g+Va+b>K&&(g=K-Ia-la-b,j=T*(g/U)):j>g?j+cb>C&&(j=C-la,g=U*(j/T)):g+Va+b>K&&(g=K-Ia-la-b,j=T*(g/U));j!==(j|0)&&(j=j+1|0);g!==(g|0)&&(g=g+1|0)}va=j+wb;Mb=g+Ia+b;a&&(Jacked.stopTween(u[0],!1,!0),i&&Jacked.stopTween(i[0],!0,!0),260>j&&(va+=260-j),a=Math.max(260,j),Wb.width=a,Wb.height=g,Qa.marginLeft= -(0.5*va+0.5|0),Qa.marginTop=-(0.5*Mb+0.5|0),Qa.width=a,Qa.height=g,u.css(Qa),i.css(Wb),w&&(Jacked.stopTween(w[0]),w.css("width",a)),v&&(Jacked.stopTween(v[0]),v.css("width",a)),r&&$a&&(Z=-G.outerHeight(),ga.css("height",-Z<g?-Z:g),Ca||(Jacked.stopTween(G[0],!1,!0),G.css("margin-top",Z))),F&&Rb(!0),Db=!0,Hb=setTimeout(Cc,100))}};var Ec,Xb={};Ec=function(a){var b=c(this).data();Xb.left=a.pageX-b.tipX-b.tipWidth;Xb.top=a.pageY-b.tipY-b.tipHeight;b.tip.css(Xb)};c.fn.jackBox=function(a,b){if(Pc.hasOwnProperty(a))Pc[a](this, b)};c.jackBox={available:function(a){a&&(Zb?N?setTimeout(a,250):a():Fa=a)}}})(jQuery);function jackboxFrameReady(){jQuery.fn.jackBox("frameReady")};